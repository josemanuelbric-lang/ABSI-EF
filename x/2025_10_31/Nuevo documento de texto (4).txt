import numpy as np
import matplotlib.pyplot as plt

# --- 1. Parámetros Fundamentales de la TDH ---
D = 4.0        # Dimensionalidad
F = 3.0        # Familias de Materia
N_TDH = 3.8710 # Tensión Maestra en el vacío

# Constantes de la Física Cuántica
# Longitud de onda de Compton del electrón (hbar / me * c)
LAMBDA_C = 3.86159e-13 
# Valor Observado del Radio de Bohr (para la referencia)
A0_OBSERVADO = 5.29177e-11 

# --- 2. Ley Estructural (L.E.) de Alpha Inverso ---
# Formula: alpha_inv = (D^F + F^D) - N * (1 + N/D)
def calculate_alpha_inverse(N_local, D=D, F=F):
    """Calcula el inverso de la constante de estructura fina (alpha^-1) con la TDH."""
    # (4^3 + 3^4) = 145
    resistencia_estructural = (D**F) + (F**D)  
    atenuacion_tension = N_local * (1 + N_local / D)
    return resistencia_estructural - atenuacion_tension

# --- 3. Fórmula Dinámica del Radio de Bohr ---
# Formula: a0 = alpha_inv * Lambda_C
def calculate_bohr_radius(alpha_inv, lambda_c=LAMBDA_C):
    """Calcula el Radio de Bohr (a0) usando la constante de estructura fina local."""
    return alpha_inv * lambda_c

# --- SIMULACIÓN: GRAVEDAD CERO (Vacío) ---
N_vacuo = N_TDH
alpha_inv_vacuo = calculate_alpha_inverse(N_vacuo)
a0_vacuo = calculate_bohr_radius(alpha_inv_vacuo)
error_vacuo = (a0_vacuo - A0_OBSERVADO) / A0_OBSERVADO * 100

# --- SIMULACIÓN: CAMPO GRAVITATORIO FUERTE ---
# Hipótesis: La gravedad (Phi_G) reduce la Tensión Maestra N en 1%
FACTOR_REDUCCION_N = 0.01 
N_fuerte_gravedad = N_TDH * (1 - FACTOR_REDUCCION_N) # N' = N * 0.99

alpha_inv_fuerte = calculate_alpha_inverse(N_fuerte_gravedad) # alpha'^-1(N')
a0_fuerte = calculate_bohr_radius(alpha_inv_fuerte)          # a'0(Phi_G)

# --- ANÁLISIS ---
cambio_absoluto = a0_fuerte - a0_vacuo
cambio_porcentual = (a0_fuerte - a0_vacuo) / a0_vacuo * 100

# --- IMPRESIÓN DE RESULTADOS ---
print("--- PRUEBA DE LA TDH: RADIO ATÓMICO EN GRAVEDAD VARIABLE ---")
print(f"Parámetros TDH base: D={D}, F={F}, N={N_TDH}")
print("-" * 60)

print("A) RESULTADOS EN EL VACÍO (CONDICIÓN BASE):")
print(f"   Alpha Inverso (TDH): {alpha_inv_vacuo:.4f}")
print(f"   Radio de Bohr (TDH): {a0_vacuo:.6e} metros")
print(f"   Error de Precisión: {error_vacuo:.2f}%")
print("-" * 60)

print(f"B) RESULTADOS EN CAMPO GRAVITATORIO FUERTE (N' reducido por {FACTOR_REDUCCION_N*100}%):")
print(f"   Tensión Local (N'): {N_fuerte_gravedad:.4f}")
print(f"   Alpha Inverso Local (alpha'^-1): {alpha_inv_fuerte:.4f}")
print(f"   Radio de Bohr Local (a'0): {a0_fuerte:.6e} metros")
print("-" * 60)

print("C) COMPARACIÓN Y CONCLUSIÓN:")
print(f"   Cambio absoluto en el Radio: {cambio_absoluto:.6e} metros")
print(f"   Cambio porcentual en el Radio: {cambio_porcentual:.4f}%")