import numpy as np
import matplotlib.pyplot as plt

# --- A. Par√°metros del Problema SAT ---
N_VARIABLES = 10 
PASOS_REQUERIDOS = 2**N_VARIABLES # 1024 Pasos/Asignaciones a verificar
PASO_DE_SOLUCION_LOGICA = PASOS_REQUERIDOS # Soluci√≥n en el √∫ltimo paso (Peor Caso NP)
N_SIMULACIONES = 1000000 # N√∫mero de veces que ejecutamos la 'm√°quina'

print("## 1. üß© Parte SAT: Definici√≥n del Problema")
print(f"Problema: SAT con {N_VARIABLES} variables.")
print(f"Tiempo de B√∫squeda (T(n)): 2^{N_VARIABLES} = {PASOS_REQUERIDOS} pasos (Worst-Case NP)")
print("-" * 50)
# --- B. Constantes TDH ---
D = 4.0
N_OBSERVABLE = 3.8710 
EPSILON = (D - N_OBSERVABLE) / D # Aprox. 0.03225

# L√≠mite de Complejidad Te√≥rico (L_MAX ~ 30.56)
L_MAX_TEORICO = -1 / np.log(1 - EPSILON) 

# --- C. Simulaci√≥n de Monte Carlo con TDH ---
resultados = {
    'Fallo Estructural': 0,
    '√âxito L√≥gico': 0,
    'Pasos Promedio Antes de Fallo': []
}

for _ in range(N_SIMULACIONES):
    falla_estructural_ocurrio = False
    
    for paso_actual in range(1, PASOS_REQUERIDOS + 1):
        
        # 1. Simulaci√≥n de la Falla F√çSICA (TDH)
        if np.random.rand() < EPSILON:
            resultados['Fallo Estructural'] += 1
            resultados['Pasos Promedio Antes de Fallo'].append(paso_actual)
            falla_estructural_ocurrio = True
            break
            
        # 2. Simulaci√≥n de la L√≥gica (SAT): Verificar la asignaci√≥n
        if paso_actual == PASO_DE_SOLUCION_LOGICA:
            resultados['√âxito L√≥gico'] += 1
            resultados['Pasos Promedio Antes de Fallo'].append(paso_actual)
            break
            
# --- D. An√°lisis de Resultados ---
colapso_promedio = np.mean(resultados['Pasos Promedio Antes de Fallo']) if resultados['Pasos Promedio Antes de Fallo'] else 0
P_FALLO = resultados['Fallo Estructural'] / N_SIMULACIONES * 100
P_EXITO = resultados['√âxito L√≥gico'] / N_SIMULACIONES * 100

print("\n## 2. ‚ö° Aplicaci√≥n de la TDH y Resultados")
print(f"Error Estructural (epsilon): {EPSILON:.5f} (o {EPSILON*100:.3f}%)")
print(f"L√≠mite Te√≥rico L_MAX: {L_MAX_TEORICO:.2f} pasos")
print("-" * 50)
print("Resultados de las 1000 ejecuciones (SAT vs. TDH):")
print(f"1. Falla Estructural (P != NP): {resultados['Fallo Estructural']} veces ({P_FALLO:.1f}%)")
print(f"2. √âxito L√≥gico (SAT Resuelto): {resultados['√âxito L√≥gico']} veces ({P_EXITO:.1f}%)")
print(f"Colapso o Finalizaci√≥n Promedio: {colapso_promedio:.2f} pasos")
print("-" * 50)

# --- E. Conclusi√≥n Gr√°fica (Demostraci√≥n P != NP)
if colapso_promedio < PASOS_REQUERIDOS * 0.5:
    print("\n‚úÖ Conclusi√≥n TDH: Prueba de $\mathbf{P} \neq \mathbf{NP}$")
    print(f"El problema SAT requer√≠a 1024 pasos, pero el proceso colaps√≥ en promedio en el paso {colapso_promedio:.2f}.")
    print("La **L√≥gica del √âxito** fue casi irrelevante; el **L√≠mite Estructural ($\mathbf{L_{MAX}}$)** impidi√≥ la finalizaci√≥n del problema **NP**.")
else:
    print("La probabilidad de fallo no fue suficiente. Pruebe con un problema N m√°s grande.")