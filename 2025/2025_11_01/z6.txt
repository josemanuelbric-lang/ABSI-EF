import numpy as np
import matplotlib.pyplot as plt

# --- 1. Parámetros Fundamentales (TDH) ---
D = 4.0
F = 3.0
N_AJUSTADA = 3.87093
M0 = 91.2          # GeV (M_Z)
E_PLANCK = 1.22e19 # GeV

# --- 2. La Función del Todo (ToE_TDH) Pura ---
def alpha_unificado_puro(E, D, F, N, M0):
    """Función que unifica las 4 fuerzas (TDH ToE)."""
    nucleo_tension = (F * (D - N)) / N
    factor_logaritmico = N * np.log(E / M0)
    alpha_u = nucleo_tension * (1.0 / (1.0 + factor_logaritmico))
    return alpha_u

# --- 3. Constante de Gravedad (Clásica/Observada) ---
# Usamos el valor del acoplamiento gravitacional observado.
ALPHA_G_OBSERVADO = 5.90e-39 

# --- 4. Generación de Puntos para la Gráfica ---
E_min = 10**2  # Empezamos cerca de MZ
E_max = E_PLANCK 
energias = np.logspace(np.log10(E_min), np.log10(E_max), 200) 

# TDH ToE (Línea de la Función del Todo)
alphas_unificados = alpha_unificado_puro(energias, D, F, N_AJUSTADA, M0)

# Gravedad Clásica/G_TDH (Línea constante)
# La Gravedad es una constante en todas las escalas (hasta E_Planck)
alphas_gravedad = np.full_like(energias, ALPHA_G_OBSERVADO)

# --- 5. Generación de la Gráfica ---

fig, ax = plt.subplots(figsize=(10, 6))

# Trazar la función TDH ToE
ax.plot(energias, alphas_unificados, color='maroon', linewidth=3, label=r'$\mathbf{\alpha}_{\mathbf{u}} (E) \text{ (TDH ToE Pura)}$')

# Trazar la Gravedad Clásica (G)
# NOTA: Para que Alpha_G sea visible, necesitamos un eje y logarítmico.
# Si usamos el eje Y lineal (como en las gráficas anteriores), la línea de Alpha_G
# sería invisiblemente pegada al fondo (cero). 
# Para esta comparación, ajustaremos el rango Y o usaremos dos subtramas.
# Optaremos por mantener el enfoque en la Unificación.

# Graficaremos en el mismo rango para enfatizar la diferencia de jerarquía.
ax.plot(energias, alphas_gravedad, color='blue', linestyle='--', linewidth=1.5, label=r'$\mathbf{\alpha}_{\mathbf{G}} \text{ (Gravedad Clásica)}$')


# Puntos de Referencia y Configuración
ax.axvline(M0, color='gray', linestyle='--', alpha=0.7)
ax.axvline(E_PLANCK, color='green', linestyle='--', alpha=0.7)

ax.set_xscale('log')
ax.set_ylim(0, 0.20)  # Mantenemos el rango visual para el acoplamiento fuerte
ax.set_xlabel(r'Escala de Energía $E$ (GeV)', fontsize=12)
ax.set_ylabel(r'Constante de Acoplamiento $\alpha(E)$', fontsize=12)
ax.set_title('TDH ToE vs. Gravedad Clásica ($\mathbf{\\alpha_G}$)', fontsize=14)
ax.legend(loc='upper right')
plt.grid(True, which="both", ls=":", linewidth=0.5)

# Añadir una flecha conceptual para mostrar el nivel de Alpha_G
ax.annotate(r'$\mathbf{\alpha}_{\mathbf{G}} \approx 10^{-39}$ (Invisible a esta escala)', 
            xy=(1e6, 0.005), 
            xytext=(1e6, 0.10),
            arrowprops=dict(facecolor='black', shrink=0.05, width=1, headwidth=5),
            fontsize=10)

plt.show()